{% extends 'base.html.twig' %}

{% block title %}Facture #{{ bill.id }}{% endblock %}

{% block body %}
  <main class="flex flex-col h-screen md:flex-row">   
		{{ include('_components/front/global/_side_bar.html.twig') }}
		<section class="flex-grow px-5 pt-8 pl-8 overflow-x-hidden overflow-y-auto">
			<h1 class="pb-4 mb-10 text-4xl">Facture #{{ bill.id }}</h1>
  
    <table class="table w-full">
        <tbody class="text-left">
            <tr>
                <th>Montant</th>
                <td>{{ bill.amount }} €</td>
            </tr>
            {% if bill.isDownPayment %}
                <tr>
                    <th>Type</th>
                    <td>Acompte</td>
                </tr>
            {% endif %}	
            <tr>
                <th>Status</th>
                <td>{{ bill.status }}</td>
            </tr>
            <tr>
                <th>Date</th>
                <td>{{ bill.date ? bill.date|date('d/m/Y') : '' }}</td>
            </tr>
            <tr>
                <th>Description</th>
                <td>{{ bill.description }}</td>
            </tr>
            <tr>
                <th>Créée par</th>
                {# TODO: aller récup le nom du user de cet id #}
                <td>{{ bill.createdBy }}</td> 
            </tr>
            <tr>
                <th>Créée le</th>
                <td>{{ bill.createdAt ? bill.createdAt|date('d/m/Y') : '' }}</td>
            </tr>
        </tbody>
    </table>

    <h2 class="text-2xl font-bold my-5">Produits</h2>
    <table class="table w-full mb-10">
        <thead class="text-left bg-gray-300 h-10">
            <tr>
                <th>Description</th>
                <th>Qté</th>
                <th>Unité</th>
                <th>Prix unitaire</th>
                <th>TVA</th>
                <th>Montant HT</th>
            </tr>
        </thead>
        <tbody class="text-left">  
            {% for product in bill.quote.productsInfo %}
                <tr>
                    <td>{{ product.description }}</td>
                    <td>{{ product.quantity }}</td>
                    <td>{{ product.unit }}</td>
                    <td>{{ product.unitPrice }} €</td>
                    <td>{{ product.tva }} %</td>
                    <td>{{ product.amount }} €</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="flex my-3 space-x-3 ">  
        <form method="post" action="{{ path('front_company_app_bill_delete', {'id': bill.id}) }}" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer cette facture ?');">
            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ bill.id) }}">
            {{ include('_components/front/global/_button_id.html.twig',
                {'path': 'front_company_app_bill_delete',
                'id': bill.id,
                'color': 'bg-gray-300',
                'title': 'Supprimer',
            }) }}   
        </form>  
    </div>
    <a href="{{ path('front_company_app_bill_index') }}" class="hover:underline"> < Retour à la liste</a>

    </section>
	</main>
{% endblock %}
 